"use strict";function RunBlock(a,b,c){var d=b("http://"+c.api.host+":"+c.api.port+"/companies"),e=d.query(function(){a.company=e[0]})}function ConfigBlock(a){var b={templateUrl:"views/main.html",controller:"MainCtrl"},c={templateUrl:"views/volunteer-list.html",controller:"VolunteerListCtrl"},d={templateUrl:"views/signin.html",controller:"SignInCtrl"},e={templateUrl:"views/signout.html",controller:"SignOutCtrl"},f={templateUrl:"views/new-volunteer.html",controller:"NewVolunteerCtrl"},g={templateUrl:"views/volunteer-timesheets.html",controller:"VolunteerTimesheetsCtrl"};a.when("/",b),a.when("/signin",d),a.when("/signout",e),a.when("/volunteer",c),a.when("/volunteer/new",f),a.when("/volunteer/:volunteerId",g),a.otherwise({redirectTo:"/"})}function MainControllerBlock(a,b,c,d,e,f){c.go=function(a){d.path(a)}}function VolunteerService(a,b){return a("http://"+b.api.host+":"+b.api.port+"/employees/:volunteerId",{},{get:{method:"GET",isArray:!0}})}function VolunteerListControllerBlock(a,b,c,d){var e=b("http://"+d.api.host+":"+d.api.port+"/employees/:volunteerId"),f=e.query(function(){a.volunteers=f})}function VolunteerTimesheetsControllerBlock(a,b,c,d,e,f,g){function h(a){var b=Math.floor(a)>0?Math.floor(a)+" hr(s) ":"",c=Math.round(60*(a-Math.floor(a)))+" mins";return b+c}a.volunteerId=d.volunteerId;var i=f.get({volunteerId:a.volunteerId},function(){a.volunteer=i[0]}),j=b("http://"+g.api.host+":"+g.api.port+"/employees/:volunteerId/attendance");a.total_time_display="Loading...",a.total_min=0;var k=j.get({volunteerId:a.volunteerId},function(){a.timesheets=k.timesheets,$.each(a.timesheets,function(b,c){a.total_min+=c.total_attendance,c.total_attendance=h(c.total_attendance),a.timesheets[a.timesheets.indexOf(c)]=c}),a.total_time_display=h(a.total_min)});a.gridOptions={data:"timesheets",sortInfo:{fields:["date_from"],directions:["desc"]},columnDefs:[{field:"date_from",displayName:"Date"},{field:"total_attendance",displayName:"Hours Worked"},{field:"department_id[1]",displayName:"Work Area"}]}}function NewVolunteerControllerBlock(a,b,c,d,e){a.formData={},a.alerts=[],a.go=function(a){d.path(a)};var f=b("http://"+e.api.host+":"+e.api.port+"/employees/:volunteerId"),g=f.query(function(){a.volunteers=g});a.processForm=function(){var b=new f(a.formData);b.$save(function(b,d,e){a.formData={},a.alerts.push({type:"success",msg:"<p>Welcome to "+c.company.name+", "+b.name+"! You are volunteer #"+b.id+".</p><p>Would you like to <a href=#>Sign In</a>?</p>"}),a.go("/")})},a.closeAlert=function(b){a.alerts.splice(b,1)}}function SignInController(a,b,c,d,e,f,g,h){var i=f.query(function(){a.volunteers=i}),j=g.query(function(){a.departments=j});a.processForm=function(){if(a.formData.employeeId&&a.formData.departmentId&&a.formData.employeeId.length>0&&a.formData.departmentId.length>0){var g=c("http://"+h.api.host+":"+h.api.port+"/employees/sign_in"),i=new g(a.formData);i.$save(function(c,g){a.formData={};var h=f.query(function(){a.volunteers=h}),i=e.open({size:"lg",template:"<div class='modal-header'><h1>You're In!</h1></div><div class='modal-body'>Time to <h2>Geek Out</h2></div>",controller:["$scope","$modalInstance",function(a,b){}]});d(function(){i.close(),b.go("/")},2500)})}else{e.open({size:"lg",template:"<div class='modal-header'>Not Signed in!</div><div class='modal-body'><h1>Choose your name and task to sign in!</h1></div>",controller:["$scope","$modalInstance",function(a,b){}]})}}}function SignOutController(a,b,c,d,e,f,g,h){var i=e.query(function(){a.volunteers=i}),j=f.query(function(){a.departments=j});a.signOut=function(f){$(".btn-sign-out#"+f).prop("disabled",!0).text("Signing Out...");var i=c("http://"+g.api.host+":"+g.api.port+"/employees/sign_out"),j=new i({employeeId:f});j.$save(function(i,j){var k=e.query(function(){a.volunteers=k}),l=h.open({size:"lg",template:"<div class='modal-header'><h1>Thank you for coming!</h1></div><div class='modal-body'><h3>Total Hours : <span ng-if='hours > 0'>{{hours}} hrs</span> {{minutes}} min</h3><!-- <h3>Today's Hours : <span ng-if='hours > 0'>{{hours}} hrs</span> {{minutes}} min</h3>--!></div>",controller:["$scope","$modalInstance","selectedId","timesheets",function(a,b,c,d){a.selectedId=c;for(var e=0,f=0;f<d.timesheets.length;f++){d.timesheets[f].total_attendance;e+=d.timesheets[f].total_attendance}a.hours=Math.floor(e),a.minutes=Math.round(60*(e-Math.floor(e)))}],resolve:{selectedId:function(){return f},timesheets:function(){var a=c("http://"+g.api.host+":"+g.api.port+"/employees/:volunteerId/attendance");return a.get({volunteerId:f}).$promise}}});d(function(){l.close(),b.go("/")},5e3)})}}function DepartmentService(a,b){return a("http://"+b.api.host+":"+b.api.port+"/departments",{})}var conserje=angular.module("conserjeApp",["ngCookies","ngResource","ngSanitize","ngRoute","ui.bootstrap","ui.select2","ui.mask","ui.validate","ngGrid"]);conserje.config(ConfigBlock),conserje.run(RunBlock),RunBlock.$inject=["$rootScope","$resource","config"],ConfigBlock.$inject=["$routeProvider"];var conserje=angular.module("conserjeApp");conserje.controller("MainCtrl",MainControllerBlock),MainControllerBlock.$inject=["$scope","$resource","$rootScope","$location","Volunteer","Department"],angular.module("conserjeApp").service("Volunteer",VolunteerService),VolunteerService.$inject=["$resource","config"];var conserje=angular.module("conserjeApp");conserje.controller("VolunteerListCtrl",VolunteerListControllerBlock),VolunteerListControllerBlock.$inject=["$scope","$resource","$rootScope","config"];var conserje=angular.module("conserjeApp");conserje.controller("VolunteerTimesheetsCtrl",VolunteerTimesheetsControllerBlock),VolunteerTimesheetsControllerBlock.$inject=["$scope","$resource","$filter","$routeParams","$rootScope","Volunteer","config"];var conserje=angular.module("conserjeApp");conserje.controller("NewVolunteerCtrl",NewVolunteerControllerBlock),NewVolunteerControllerBlock.$inject=["$scope","$resource","$rootScope","$location","config"],angular.module("conserjeApp").controller("SignInCtrl",SignInController),SignInController.$inject=["$scope","$rootScope","$resource","$timeout","$modal","Volunteer","Department","config"],angular.module("conserjeApp").controller("SignOutCtrl",SignOutController),SignOutController.$inject=["$scope","$rootScope","$resource","$timeout","Volunteer","Department","config","$modal"];var Config={api:{host:"127.0.0.1",port:3e3}};angular.module("conserjeApp").constant("config",Config),angular.module("conserjeApp").constant("ApiConfig",42),angular.module("conserjeApp").service("Department",DepartmentService),DepartmentService.$inject=["$resource","config"];